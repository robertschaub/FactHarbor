{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "XWiki Viewer: Open",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-ExecutionPolicy", "Bypass",
        "-File", "${workspaceFolder}/Docs/xwiki-export/Open-XWikiViewer.ps1"
      ],
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "isBackground": true,
      "group": "none",
      "detail": "Start local server and open XWiki Viewer in Chrome with folder picker"
    },
    {
      "label": "XWiki Viewer: Open (Edge)",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-ExecutionPolicy", "Bypass",
        "-File", "${workspaceFolder}/Docs/xwiki-export/Open-XWikiViewer.ps1",
        "-Browser", "edge"
      ],
      "problemMatcher": [],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "dedicated",
        "showReuseMessage": false,
        "clear": true
      },
      "isBackground": true,
      "group": "none",
      "detail": "Start local server and open XWiki Viewer in Edge"
    },
    {
      "label": "XWiki Viewer: Quick Open (no server)",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-Command",
        "$viewerUrl = 'file:///' + ('${workspaceFolder}/Docs/xwiki-export/xwiki-viewer.html' -replace '\\\\','/') + '?open=folder'; $chrome = @(\"$env:ProgramFiles\\Google\\Chrome\\Application\\chrome.exe\", \"${env:ProgramFiles(x86)}\\Google\\Chrome\\Application\\chrome.exe\", \"$env:LOCALAPPDATA\\Google\\Chrome\\Application\\chrome.exe\") | Where-Object { Test-Path $_ } | Select-Object -First 1; if ($chrome) { Start-Process $chrome $viewerUrl } else { Start-Process 'msedge' $viewerUrl }"
      ],
      "problemMatcher": [],
      "presentation": {
        "reveal": "silent",
        "panel": "shared"
      },
      "detail": "Open viewer directly via file:// in Chrome (Edge fallback), no server needed"
    }
  ]
}
