= AKEL — AI Knowledge Extraction Layer =

AKEL is FactHarbor's automated analysis engine — the core subsystem that transforms unstructured text and URLs into structured, transparent claim analyses with evidence-based verdicts.

{{info}}
**Current Implementation:** v2.10.2 (POC) — Single-node pipeline in TypeScript/Next.js. All outputs are AI-generated and clearly labeled. Analysis data is immutable — quality is improved through system configuration, not data edits.
{{/info}}

== 1. What AKEL Does ==

{{mermaid}}
flowchart LR
    subgraph Input["What goes in"]
        URL["URL"]
        TEXT["Text or Claim"]
    end

    subgraph AKEL["AKEL Analysis Engine"]
        direction TB
        U["Understand\nclaims & contexts"]
        R["Research\nevidence from web"]
        V["Evaluate\nverdicts & confidence"]
        S["Report\ntransparent output"]
        U --> R --> V --> S
    end

    subgraph Output["What comes out"]
        VERDICT["Structured Verdict\nper claim + overall"]
        EVIDENCE["Evidence Trail\nsources & excerpts"]
        REPORT["Analysis Report\nhuman-readable"]
    end

    Input --> AKEL --> Output

    style AKEL fill:#e8f5e9,stroke:#2e7d32,color:#000
    style Input fill:#e3f2fd,stroke:#1565c0,color:#000
    style Output fill:#fff9c4,stroke:#f9a825,color:#000
{{/mermaid}}

//AKEL takes user-submitted text or URLs, analyses the claims against web evidence, and produces structured verdicts with full evidence provenance.//

**Core capabilities:**

* **Claim extraction** — Decomposes articles into individual, testable claims with dependency chains
* **AnalysisContext detection** — Identifies bounded analytical frames (legal, methodological, temporal) requiring separate verdicts
* **Evidence research** — Iteratively searches the web, fetches sources, and extracts evidence with quality filtering
* **Source reliability scoring** — Evaluates source credibility using LLM assessment with cross-provider consensus
* **Verdict generation** — Produces per-claim verdicts on a 7-point truth scale (TRUE → FALSE) with confidence scores
* **Quality enforcement** — Gates validate claims and assess verdict confidence before output

== 2. Design Principles ==

{{mermaid}}
flowchart TB
    subgraph Principles["AKEL Design Principles"]
        direction LR
        P1["Generic by Design\nNo domain-specific\nhardcoding"]
        P2["Evidence Grounded\nNo synthetic evidence\nReal URLs + excerpts"]
        P3["Fail Closed\nMissing provenance\ndegrades confidence"]
        P4["Input Neutral\nQuestions & statements\ntreated equivalently"]
    end

    style Principles fill:#f3e5f5,stroke:#6a1b9a,color:#000
{{/mermaid}}

|= Principle |= What it means
| **Generic by design** | No domain-specific keyword lists or hardcoded rules — AKEL works across any topic
| **Evidence grounded** | Every verdict is traceable to fetched sources with real URLs and excerpts
| **Fail closed** | Missing or invalid provenance degrades confidence or triggers fallback — never hallucinate
| **Input neutral** | Questions and statements produce comparable results (≤4 point divergence target)
| **Fix the system, not the data** | Analysis outputs are immutable; improvements flow through UCM configuration changes

== 3. The Analysis Pipeline ==

AKEL processes input through a structured pipeline with quality gates at critical junctures:

{{mermaid}}
flowchart TB
    INPUT["User Input\n(text or URL)"] --> STEP1

    subgraph STEP1["1. Understand"]
        CLAIMS["Extract claims\nwith dependencies"]
        CONTEXTS["Detect analysis\ncontexts"]
        FACTORS["Discover\nKeyFactors"]
        GATE1{{"Gate 1\nClaim Validation"}}
        CLAIMS --> GATE1
        CONTEXTS ~~~ FACTORS
    end

    STEP1 --> STEP2

    subgraph STEP2["2. Research (iterative)"]
        QUERY["Generate\nsearch queries"]
        FETCH["Fetch & parse\nsources"]
        FILTER["Filter evidence\n(7-layer defense)"]
        QUERY --> FETCH --> FILTER
        FILTER -.->|"gaps remain"| QUERY
    end

    STEP2 --> STEP3

    subgraph STEP3["3. Verdict"]
        PERCLAIM["Per-claim verdicts\n(7-point scale)"]
        AGG["Aggregate weighted\nverdicts"]
        GATE4{{"Gate 4\nConfidence Assessment"}}
        PERCLAIM --> AGG --> GATE4
    end

    STEP3 --> STEP4["4. Summary"] --> STEP5["5. Report"] --> RESULT["AnalysisResult\n+ Markdown Report"]

    style STEP1 fill:#e8f5e9,stroke:#2e7d32,color:#000
    style STEP2 fill:#e3f2fd,stroke:#1565c0,color:#000
    style STEP3 fill:#fff9c4,stroke:#f9a825,color:#000
    style STEP4 fill:#f3e5f5,stroke:#6a1b9a,color:#000
    style STEP5 fill:#f3e5f5,stroke:#6a1b9a,color:#000
{{/mermaid}}

//Step 2 (Research) is iterative — AKEL keeps searching until evidence is sufficient or the budget is exhausted. Quality gates at Step 1 and Step 3 prevent low-quality claims and verdicts from reaching the output.//

== 4. Pipeline Variants ==

{{mermaid}}
flowchart LR
    INPUT["User Input"] --> DISPATCH{{"Pipeline\nDispatch"}}

    DISPATCH -->|"orchestrated\n(default)"| ORCH["Orchestrated\nComprehensive · 2-5 min\nFull quality gates"]
    DISPATCH -->|"monolithic_dynamic"| DYN["Monolithic Dynamic\nStreamlined · 20-60s\nFast alternative"]

    ORCH --> RESULT["Structured\nResult"]
    DYN --> RESULT

    style ORCH fill:#c8e6c9,stroke:#2e7d32,color:#000
    style DYN fill:#e3f2fd,stroke:#1565c0,color:#000
{{/mermaid}}

|= |= Orchestrated (default) |= Monolithic Dynamic
| **Approach** | Multi-step workflow with iterative research | Single LLM tool-loop
| **Quality** | Comprehensive | Streamlined
| **Speed** | 2-5 minutes | 20-60 seconds
| **Use case** | Primary analysis | Fast check, second opinion

Both variants share common infrastructure (source reliability, budget enforcement, truth scale mapping) and produce results through a common envelope. See [[Pipeline Variants>>FactHarbor.Specification.Architecture.Deep Dive.Pipeline Variants.WebHome]] for details.

== 5. Quality Assurance ==

AKEL enforces quality through automated gates, not human review:

{{mermaid}}
flowchart LR
    subgraph Gates["Quality Gates"]
        G1["Gate 1\nClaim Validation\n(UNDERSTAND phase)"]
        G4["Gate 4\nVerdict Confidence\n(VERDICT phase)"]
    end

    subgraph Defense["Evidence Quality"]
        EF["7-Layer Defense\nagainst low-quality\nevidence"]
    end

    subgraph Trust["Source Trust"]
        SR["Source Reliability\nLLM-evaluated\ncredibility scoring"]
    end

    Gates ~~~ Defense ~~~ Trust

    style Gates fill:#fff9c4,stroke:#f9a825,color:#000
    style Defense fill:#e3f2fd,stroke:#1565c0,color:#000
    style Trust fill:#e8f5e9,stroke:#2e7d32,color:#000
{{/mermaid}}

* **Gate 1** (Claim Validation) — Filters non-factual content; keeps all central claims
* **Gate 4** (Confidence Assessment) — Ensures verdicts have sufficient evidence backing (minimum 2 sources)
* **Evidence filtering** — 7-layer defense: quality filtering, provenance validation, baseless pruning, relevance filtering, opinion pruning, contestation validation, context routing
* **Source reliability** — LLM-evaluated credibility scoring with multi-provider consensus and caching

== 6. Verdict Scale ==

AKEL uses a 7-point truth scale, distinguishing between knowledge gaps (UNVERIFIED) and genuine conflict (MIXED):

|= Verdict |= Truth Range |= Meaning
| **TRUE** | 86-100% | Well supported by evidence
| **MOSTLY TRUE** | 72-85% | Largely supported with minor caveats
| **LEANING TRUE** | 58-71% | More supporting than contradicting evidence
| **MIXED / UNVERIFIED** | 43-57% | Genuine conflict (MIXED, confidence ≥60%) or insufficient evidence (UNVERIFIED, confidence <60%)
| **LEANING FALSE** | 29-42% | More contradicting than supporting evidence
| **MOSTLY FALSE** | 15-28% | Largely contradicted
| **FALSE** | 0-14% | Refuted by evidence

== 7. Future Capabilities ==

{{warning}}
The following features are **planned but not yet implemented**. They represent the target production architecture (Alpha/Beta/V1.0).
{{/warning}}

=== 7.1 Risk Tiers ===

Planned risk classification to guide labeling and audit rates:
* **Tier A (High Risk)**: Medical, legal, elections — published with strong warnings, higher sampling audit rate
* **Tier B (Medium Risk)**: Contested policy, complex science — sampling audits
* **Tier C (Low Risk)**: Definitions, established facts — standard labeling

=== 7.2 Enhanced Quality Gates ===

* **Gate 2**: Mandatory contradiction search (counter-evidence, reservations, bubble detection)
* **Gate 3**: Uncertainty quantification (confidence scores, limitations, data gaps)

=== 7.3 Audit System ===

Planned stratified sampling audits by risk tier, confidence score, and traffic.

=== 7.4 Federation ===

In Release 1.0+, AKEL will participate in cross-node knowledge alignment:
* Share embeddings and canonicalized claim forms
* Exchange contradiction alerts
* Trust-level-based data exchange between nodes

== 8. Architecture References ==

For implementation details:
* [[AKEL Pipeline>>FactHarbor.Specification.Architecture.AKEL Pipeline.WebHome]] — Pipeline overview with diagrams, shared modules, budget controls
* [[Orchestrated Pipeline (Deep Dive)>>FactHarbor.Specification.Architecture.Deep Dive.Orchestrated Pipeline.WebHome]] — Step-by-step implementation, function names, LLM call points
* [[Pipeline Variants (Deep Dive)>>FactHarbor.Specification.Architecture.Deep Dive.Pipeline Variants.WebHome]] — Invariants, shared primitives, result model, configuration
* [[Quality Gates>>FactHarbor.Specification.Architecture.Deep Dive.Quality Gates.WebHome]] — Gate criteria, confidence penalties
* [[Source Reliability>>FactHarbor.Specification.Architecture.Deep Dive.Source Reliability.WebHome]] — LLM evaluation, caching, multi-language support
* [[Calculations and Verdicts>>FactHarbor.Specification.Architecture.Deep Dive.Calculations and Verdicts.WebHome]] — Verdict formulas, aggregation, weighting

== 9. Related Pages ==

* [[Architecture>>FactHarbor.Specification.Architecture.WebHome]] — System architecture overview
* [[Data Model>>FactHarbor.Specification.Data Model.WebHome]] — Entity relationships and schema
* [[Automation>>FactHarbor.Specification.Automation.WebHome]] — Automation philosophy and roadmap
* [[Roles & Content States>>FactHarbor.Specification.Requirements.Roles.WebHome]] — User roles and content lifecycle
* [[Workflows>>FactHarbor.Specification.Workflows.WebHome]] — Process workflows
