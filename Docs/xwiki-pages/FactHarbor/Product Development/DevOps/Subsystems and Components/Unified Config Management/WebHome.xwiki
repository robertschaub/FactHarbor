= Unified Config Management (UCM) =

== 1. Introduction ==

=== What is UCM? ===

**Unified Config Management (UCM)** is FactHarbor's system for managing analysis configurations through **reusable profiles**. Instead of tweaking settings every time you run an analysis, create named profiles for different scenarios.

=== Why Use UCM? ===

**Without UCM**:
* Manually set search parameters, prompt templates, and calculation thresholds for each analysis
* Inconsistent settings across analyses
* No way to share configurations with team members

**With UCM**:
* Save configurations as named profiles ("High-Stakes Fact-Checking", "Exploratory Research")
* Switch between profiles with one click
* Import/export profiles for team sharing
* Version control for configuration changes
* Rollback to previous configurations easily

=== Key Concepts ===

**Profile**: A named configuration **per config type** (e.g., ##pipeline:default##, ##search:default##).
There is no single combined profile object; each config type is versioned independently.

**Configuration Types**:
* **PipelineConfig** — LLM provider selection, model routing, budgets, feature flags
* **SearchConfig** — Web search behavior (provider, max results, timeouts)
* **CalcConfig** — Calculation thresholds and verdict bands
* **PromptConfig** — Prompt profiles (pipeline + text-analysis templates) stored in UCM
* **Evidence Lexicon** — Evidence filtering patterns (UCM lexicon)
* **Aggregation Lexicon** — Aggregation heuristics (UCM lexicon)
* **Source Reliability (SR)** — SR service config (separate SR domain)

**Default Profile**: Built-in profile used when no custom profile selected

----

== 2. Config Source Precedence (Alpha) ==

=== 2.1 Config Loading Flow ===

The diagram below shows how FactHarbor loads, validates, and activates configurations at runtime:

{{include reference="FactHarbor.Product Development.Diagrams.UCM Config Precedence.WebHome"/}}

**Key Points**:
* **Runtime Authority**: Database is the source of truth during execution
* **Fresh DB Seeding**: On first startup, configs are loaded from JSON files
* **Validation**: All configs are validated against Zod schemas before activation
* **Fallback Chain**: Database → JSON files → Code constants
* **Manual Updates**: Admin UI changes create new versions in the database
* **Dev Mode**: Saving to files is restricted to development environments

=== 2.2 Where Configs Live ===

1. **Runtime Authority:** Database (active config in UCM)
1. **Default Templates:** JSON files in ##apps/web/configs/##
1. **Fallback:** Code constants in ##config-schemas.ts##

=== 2.3 Update Scenarios ===

|= Scenario |= Behavior |= Notes
| Fresh DB | File → DB | On first startup, seed from files
| File updated | **Manual reset required** | DB unchanged; admin must Reset to Default
| DB updated via UI | File unchanged | Only affects DB; files stay as templates
| Save-to-File invoked | DB → File | Overwrites file (dev mode only; not enabled in alpha)

=== 2.4 Alpha Limitations ===

* No automatic drift detection UI
* No automatic merging of file updates
* File changes require manual admin action

=== 2.5 Save to File (Development Mode) ===

In development, you can save active DB configs back to default files:

1. Navigate to Admin → Config → [config type]
1. Make your changes and save to DB
1. Click "Save to File" button (appears only in development)
1. Preview with "Preview Save to File" before committing

**Safety Features:**
* Only works in ##NODE_ENV=development## or with ##FH_ALLOW_CONFIG_FILE_WRITE=true##
* Creates ##.bak## backup before overwriting
* Atomic writes (.tmp → rename)
* Schema validation before write

**Production:** Save-to-file is blocked by default in production for safety.

----

== 3. Configuration Profiles ==

=== Profile Structure ===

Each config type has its own profile:

{{code language="typescript"}}
interface ConfigProfile<T> {
  configType: "pipeline" | "search" | "calculation" | "prompt" | "sr" | "evidence-lexicon" | "aggregation-lexicon";
  profileKey: string;            // Usually "default"
  content: T;                    // Config JSON or prompt content
  createdAt: string;             // ISO 8601 timestamp
  updatedAt: string;             // ISO 8601 timestamp
}
{{/code}}

=== Profile List View ===

**Location**: Navigate to ##/admin/config##

**Features**:
* View all available profiles
* See which profile is active (highlighted)
* Quick switch between profiles
* Create new profile
* Import/export profiles

**Example Profiles**:

|= Profile Name |= Description |= Use Case
| **Default** | Standard balanced settings | General fact-checking
| **High-Stakes** | Strict quality gates, conservative verdicts | Legal, medical, high-impact claims
| **Exploratory** | Lenient filters, more evidence | Research, hypothesis generation
| **Budget** | Minimal searches, token limits | Cost-sensitive analyses

----

== 4. Profile Management ==

=== Creating a New Profile ===

**Steps**:
1. Navigate to ##/admin/config##
1. Click **"Create New Profile"** button
1. Enter profile details:
** **Name**: Descriptive name (e.g., "Medical Claims Analysis")
** **Description**: Purpose and use case
1. Configure settings:
** **Search**: Provider, max results, timeouts, domain filters
** **Prompts**: LLM provider, temperature, token limits
** **Calculation**: Verdict bands, quality gates, evidence filters
1. Click **"Save Profile"**
1. Profile appears in profile list

**Tips**:
* Start from an existing profile (duplicate it first)
* Use descriptive names that indicate the use case
* Document any non-standard settings in the description

=== Editing a Profile ===

**Steps**:
1. Navigate to ##/admin/config##
1. Click on profile name to open
1. Modify settings in any of the config sections
1. Click **"Save Changes"**
1. System creates a new version (version history preserved)

**Version Control**:
* Each save creates a new version timestamp
* Previous versions preserved for rollback
* View version history via **"History"** button

=== Duplicating a Profile ===

**Use Case**: Create a variation of an existing profile

**Steps**:
1. Navigate to ##/admin/config##
1. Select profile to duplicate
1. Click **"Duplicate"** button
1. Enter new profile name
1. System creates copy with suffix " (Copy)"
1. Edit as needed

=== Deleting a Profile ===

**Steps**:
1. Navigate to ##/admin/config##
1. Select profile to delete
1. Click **"Delete"** button
1. Confirm deletion

**Restrictions**:
* Cannot delete the Default profile
* Cannot delete active profile (switch to another first)
* Deletion is permanent (no undo)

=== Importing a Profile ===

**Use Case**: Load a profile shared by a team member or from backup

**Steps**:
1. Navigate to ##/admin/config##
1. Click **"Import Profile"** button
1. Select profile JSON file
1. System validates profile structure
1. If valid, profile appears in list
1. If invalid, error message shows what's wrong

**Profile JSON Format**:

{{code language="json"}}
{
  "name": "Medical Claims Analysis",
  "description": "Strict settings for medical fact-checking",
  "searchConfig": { "..." : "..." },
  "promptConfig": { "..." : "..." },
  "calcConfig": { "..." : "..." }
}
{{/code}}

=== Exporting a Profile ===

**Use Case**: Share profile with team members or create backup

**Steps**:
1. Navigate to ##/admin/config##
1. Select profile to export
1. Click **"Export"** button
1. System downloads JSON file (e.g., ##profile-medical-claims.json##)
1. Share file via email, Slack, or version control

**Best Practices**:
* Export after major configuration changes (backup)
* Include version number in filename (e.g., ##profile-medical-v2.json##)
* Store exported profiles in version control (Git)

----

== 5. Configuration Types ==

=== 5.1 SearchConfig ===

**Purpose**: Controls web search behavior

**Key Settings**:

|= Setting |= Description |= Default |= Range
| **provider** | Search provider (auto/google/bing/serper) | ##auto## | —
| **mode** | Search mode (standard/deep/quick) | ##standard## | —
| **maxResults** | Max search results per query | ##6## | 1–20
| **maxSourcesPerIteration** | Max sources to fetch per iteration | ##4## | 1–10
| **timeoutMs** | Search timeout in milliseconds | ##12000## | 1000–60000
| **dateRestrict** | Filter by date (e.g., "m6" for 6 months) | ##null## | —
| **domainWhitelist** | Only search these domains (empty = all) | ##[]## | —
| **domainBlacklist** | Exclude these domains | ##[]## | —

**Example SearchConfig**:

{{code language="json"}}
{
  "provider": "google",
  "mode": "deep",
  "maxResults": 12,
  "maxSourcesPerIteration": 6,
  "timeoutMs": 20000,
  "dateRestrict": "y1",
  "domainWhitelist": ["nih.gov", "cdc.gov", "nature.com"],
  "domainBlacklist": []
}
{{/code}}

**Use Case**: Medical claims requiring peer-reviewed sources only

=== 5.2 PromptConfig ===

**Purpose**: Stores prompt text templates by profile. Runtime behavior fields (provider, model routing, budget controls) are in ##PipelineConfig##.

**Supported Prompt Profiles**:

|= Profile Key |= Used By |= Default File Path
| ##orchestrated## | Orchestrated analysis pipeline | ##apps/web/prompts/orchestrated.prompt.md##
| ##monolithic-dynamic## | Monolithic dynamic pipeline | ##apps/web/prompts/monolithic-dynamic.prompt.md##
| ##source-reliability## | Source reliability evaluator | ##apps/web/prompts/source-reliability.prompt.md##
| ##text-analysis-input## | Input classification stage | ##apps/web/prompts/text-analysis/text-analysis-input.prompt.md##
| ##text-analysis-evidence## | Evidence-quality stage | ##apps/web/prompts/text-analysis/text-analysis-evidence.prompt.md##
| ##text-analysis-context## | Context similarity stage | ##apps/web/prompts/text-analysis/text-analysis-context.prompt.md##
| ##text-analysis-verdict## | Verdict-validation stage | ##apps/web/prompts/text-analysis/text-analysis-verdict.prompt.md##

**Operational Notes**:
* Prompt import/export/reseed APIs validate profile keys against the canonical allowlist.
* For ##text-analysis-*## profiles, frontmatter pipeline is validated as ##text-analysis##.
* Prompt text that influences analysis should be managed via UCM prompt profiles (not hardcoded in runtime code).

=== 5.3 CalcConfig ===

**Purpose**: Controls verdict calculation, evidence filtering, and aggregation

==== Verdict Bands ====

{{code language="typescript"}}
verdictBands: {
  true: [86, 100],          // 86-100% confidence = "True"
  mostlyTrue: [72, 85],     // 72-85% = "Mostly True"
  leaningTrue: [58, 71],    // 58-71% = "Leaning True"
  mixed: [43, 57],          // 43-57% = "Mixed"
  leaningFalse: [29, 42],   // 29-42% = "Leaning False"
  mostlyFalse: [15, 28],    // 15-28% = "Mostly False"
  false: [0, 14],           // 0-14% = "False"
}
{{/code}}

==== Aggregation Weights ====

{{code language="typescript"}}
aggregation: {
  centralityWeights: { high: 3.0, medium: 2.0, low: 1.0 },
  harmPotentialMultiplier: 1.5,
  contestationWeights: { established: 0.3, disputed: 0.5, opinion: 1.0 },
}
{{/code}}

==== probativeValue Weights ====

{{code language="typescript"}}
probativeValueWeights: {
  high: 1.0,    // Well-attributed, specific evidence (100% weight)
  medium: 0.8,  // Moderately specific evidence (80% weight)
  low: 0.5,     // Vague evidence (50% weight, usually filtered)
}
{{/code}}

==== sourceType Calibration ====

{{code language="typescript"}}
sourceTypeCalibration: {
  peer_reviewed_study: 1.0,    // Academic research (baseline)
  fact_check_report: 1.05,     // Fact-checking orgs (+5% boost)
  government_report: 1.0,      // Official gov sources (baseline)
  legal_document: 1.0,         // Court rulings (baseline)
  news_primary: 1.0,           // Primary journalism (baseline)
  news_secondary: 0.95,        // News aggregation (-5%)
  expert_statement: 0.9,       // Expert opinions (-10%)
  organization_report: 0.95,   // NGO/think tank reports (-5%)
  other: 0.8,                  // Unclassified sources (-20%)
}
{{/code}}

==== Evidence Filter Rules ====

{{code language="typescript"}}
evidenceFilter: {
  minStatementLength: 20,           // Min characters for evidence statement
  maxVaguePhraseCount: 2,           // Max vague phrases allowed
  requireSourceExcerpt: true,       // Must have source excerpt
  minExcerptLength: 30,             // Min excerpt characters
  requireSourceUrl: true,           // Must have source URL
  deduplicationThreshold: 0.85,     // Jaccard similarity (0-1)
}
{{/code}}

**Use Cases**:
* **High-Stakes**: Lower thresholds, stricter filters
* **Exploratory**: Higher thresholds, lenient filters
* **Budget**: Moderate settings, balance cost vs quality

=== 5.4 PipelineConfig ===

**Purpose**: Controls LLM provider selection, model routing, budgets, feature flags, and **claim filtering behavior**.

**Key Settings**:

|= Setting |= Description |= Default |= Range
| **llmProvider** | Default LLM provider | ##anthropic## | anthropic/openai/google
| **llmModel** | Default model (null = provider default) | ##null## | —
| **llmTemperature** | LLM temperature | ##0.2## | 0.0–1.0
| **llmTiering** | Enable model tiering | ##false## | —
| **searchEnabled** | Enable search step | ##true## | —

==== Additional Admin-Exposed Fields (Current UI) ====

|= Setting |= Description |= Default
| **understandMaxChars** | Max input chars sent to UNDERSTAND | ##12000##
| **understandLlmTimeoutMs** | LLM timeout for UNDERSTAND stage | ##600000##
| **extractEvidenceLlmTimeoutMs** | LLM timeout for EXTRACT_EVIDENCE stage | ##300000##
| **temporalPromptContractTemplate** | Temporal contract template injected into prompts | UCM default text
| **temporalPromptKnowledgeRuleAllowed** | Knowledge rule when model knowledge is allowed | UCM default text
| **temporalPromptKnowledgeRuleEvidenceOnly** | Knowledge rule for evidence-only runs | UCM default text
| **temporalPromptRecencyRuleSensitive** | Recency rule for time-sensitive claims | UCM default text
| **temporalPromptRecencyRuleGeneral** | Recency rule for general claims | UCM default text
| **temporalPromptNoFreshEvidenceRule** | Guardrail when fresh evidence is missing | UCM default text
| **temporalPromptRelativeTimeRule** | Relative-time wording guardrail | UCM default text
| **gapResearchEnabled** | Enable post-pass gap-driven research | ##true##
| **gapResearchMaxIterations** | Max gap-research iterations | ##2##
| **gapResearchMaxQueries** | Max gap-research queries | ##8##

==== Claim Filtering Options ====

These options control the multi-layer claim filtering system:

|= Setting |= Description |= Default |= Range
| **thesisRelevanceValidationEnabled** | Validate thesis relevance classifications | ##true## | —
| **thesisRelevanceLowConfidenceThreshold** | Flag low-confidence relevance (warn) | ##70## | 0–100
| **thesisRelevanceAutoDowngradeThreshold** | Auto-downgrade direct→tangential | ##60## | 0–100
| **minEvidenceForTangential** | Min evidence required for tangential claims | ##2## | 0–10
| **tangentialEvidenceQualityCheckEnabled** | Extra quality check for tangential | ##false## | —
| **maxOpinionFactors** | Max opinion keyFactors (0=unlimited) | ##0## | 0–20
| **opinionAccumulationWarningThreshold** | Warn if opinion % exceeds this | ##70## | 0–100

**Example PipelineConfig (Claim Filtering)**:

{{code language="json"}}
{
  "thesisRelevanceValidationEnabled": true,
  "thesisRelevanceLowConfidenceThreshold": 70,
  "thesisRelevanceAutoDowngradeThreshold": 60,
  "minEvidenceForTangential": 2,
  "tangentialEvidenceQualityCheckEnabled": false,
  "maxOpinionFactors": 0,
  "opinionAccumulationWarningThreshold": 70
}
{{/code}}

**Behavior**:

1. **Thesis Relevance Validation**: When enabled, validates LLM relevance classifications:
** If confidence < ##thesisRelevanceLowConfidenceThreshold## (70): logs warning
** If confidence < ##thesisRelevanceAutoDowngradeThreshold## (60): auto-downgrades "direct" to "tangential"
1. **Tangential Claim Pruning**: Claims marked "tangential" require ##minEvidenceForTangential## (2) supporting facts to appear in the final report. This prevents baseless tangential claims from diluting the analysis.
1. **Opinion Monitoring**: Tracks opinion-based keyFactors:
** If ##maxOpinionFactors## > 0: prunes excess opinion factors
** If opinion % exceeds ##opinionAccumulationWarningThreshold##: logs warning

**Use Cases**:
* **Strict Fact-Checking**: Set ##minEvidenceForTangential: 3##, ##thesisRelevanceAutoDowngradeThreshold: 70##
* **Opinion-Tolerant**: Set ##maxOpinionFactors: 5##, ##opinionAccumulationWarningThreshold: 90##
* **Development/Debug**: Set ##tangentialEvidenceQualityCheckEnabled: true## for extra validation

----

== 6. Common Use Cases ==

=== 6.1 High-Stakes Fact-Checking ===

**Scenario**: Verifying claims that could impact policy, health, or legal decisions

**Profile Configuration**:

**SearchConfig**:
* Provider: ##google## (highest quality)
* Mode: ##deep## (exhaustive search)
* maxResults: ##12## (gather more evidence)
* domainWhitelist: Trusted sources only (nih.gov, gov, .edu, nature.com, etc.)

**PipelineConfig**:
* llmProvider: ##anthropic## (strong reasoning on complex claims)
* modelVerdict: high-quality reasoning model
* deterministic: ##true## (reproducible outputs)
* allowModelKnowledge: ##false## (evidence-first)

**CalcConfig**:
* Verdict bands: Conservative (shift thresholds higher)
* probativeValueWeights: Strict — reduce medium weight to 0.7, low to 0.3
* evidenceFilter: Strict — minStatementLength 30, maxVaguePhraseCount 1, minExcerptLength 50, deduplicationThreshold 0.90

**Result**: Conservative verdicts with high confidence thresholds

=== 6.2 Exploratory Research ===

**Scenario**: Exploring a topic to generate hypotheses, not making definitive verdicts

**Profile Configuration**:

**SearchConfig**:
* Provider: ##auto## (any available)
* Mode: ##standard##
* maxResults: ##10##
* domainWhitelist: ##[]## (no restrictions)

**PipelineConfig**:
* llmProvider: ##google## (or preferred exploratory provider)
* analysisMode: ##deep##
* allowModelKnowledge: ##true## (broader context exploration)
* llmTiering: ##true## (cost-balanced)

**CalcConfig**:
* Verdict bands: Standard (default)
* probativeValueWeights: Lenient — medium 0.9, low 0.6
* evidenceFilter: Lenient — minStatementLength 15, maxVaguePhraseCount 3, requireSourceExcerpt false, deduplicationThreshold 0.80

**Result**: More evidence collected, broader perspective, exploratory verdicts

=== 6.3 Budget-Constrained Analysis ===

**Scenario**: Minimize API costs while maintaining acceptable quality

**Profile Configuration**:

**SearchConfig**:
* Provider: ##bing## (lower cost than Google)
* Mode: ##quick##
* maxResults: ##4## (minimal)
* maxSourcesPerIteration: ##2##
* timeoutMs: ##8000## (shorter timeout)

**PipelineConfig**:
* llmTiering: ##true## (cheaper models for simpler stages)
* modelExtractEvidence: lower-cost extraction model
* maxTotalTokens: reduced budget cap
* maxTokensPerCall: reduced per-call cap

**CalcConfig**:
* Verdict bands: Standard
* probativeValueWeights: Standard (default)
* evidenceFilter: Standard (default)

**Result**: Lower cost (~40% reduction), acceptable quality for non-critical analyses

=== 6.4 Domain-Specific Analyses ===

**Scenario**: Legal claim analysis requiring case law and statutes

**Profile Configuration**:

**SearchConfig**:
* domainWhitelist: ##["supremecourt.gov", "law.cornell.edu", "justia.com", "courtlistener.com"]##
* maxResults: ##8##
* dateRestrict: ##null## (include historical cases)

**PipelineConfig + Prompt Profiles**:
* llmProvider: ##anthropic##
* modelVerdict: high-quality reasoning model
* Customize domain instructions in UCM prompt profile (usually ##prompt:orchestrated##)

**CalcConfig**:
* sourceTypeCalibration: Boost legal sources — legal_document 1.10, government_report 1.05, other 0.6
* evidenceFilter: Require citations

**Result**: Legal-focused evidence with proper citations

----

== 7. Troubleshooting ==

=== Profile Not Saving ===

**Symptoms**: Click "Save", but changes don't persist

**Causes**:
1. **Invalid JSON**: Config contains syntax errors
1. **Missing required fields**: Essential fields (name, description) empty
1. **Schema validation failure**: Values outside allowed ranges

**Solutions**:
1. Check browser console for validation errors (F12 → Console tab)
1. Verify all required fields have values
1. Check value ranges: maxResults 1–20, contextDedupThreshold 0.5–1.0, timeoutMs 1000–60000

=== Profile Import Fails ===

**Symptoms**: Error message when importing profile JSON

**Causes**:
1. **Malformed JSON**: Syntax error in file
1. **Incompatible version**: Profile from older/newer FactHarbor version
1. **Missing fields**: Required fields not present

**Solutions**:
1. Validate JSON using an online validator
1. Check FactHarbor version compatibility
1. Compare with exported profile from current version to identify missing fields

=== Analysis Using Wrong Profile ===

**Symptoms**: Analysis results don't match expected profile settings

**Causes**:
1. **Profile not set as active**: Default profile still selected
1. **Cache issue**: Browser cached old profile
1. **Job queue used old profile**: Job created before profile switch

**Solutions**:
1. Verify active profile highlighted in profile list
1. Hard refresh browser (Ctrl+Shift+R)
1. Create new analysis job (don't reuse old job)

=== Evidence Filter Too Strict ===

**Symptoms**: Most evidence filtered out, verdicts unreliable due to insufficient evidence

**Indicators**:
* Filter stats show >50% filtered
* FP rate >20% (filtering valid evidence)
* Verdict confidence very low

**Solutions**:
1. Check evidenceFilter settings:
** Increase ##minStatementLength## if filtering valid short statements
** Increase ##maxVaguePhraseCount## if filtering contextually valid evidence
** Decrease ##deduplicationThreshold## if filtering distinct evidence
1. Review filter logs to identify most common filter reasons
1. Consider using "Exploratory" profile template as starting point

=== Evidence Filter Too Lenient ===

**Symptoms**: Low-quality evidence passing through, verdicts unreliable

**Indicators**:
* Evidence contains many vague phrases
* sourceExcerpts are LLM-generated ("Based on...")
* Duplicate evidence items
* FP rate <5% (filter not catching enough)

**Solutions**:
1. Check evidenceFilter settings:
** Decrease ##minStatementLength## if allowing too-short statements
** Decrease ##maxVaguePhraseCount## to catch vague evidence
** Increase ##deduplicationThreshold## for more aggressive dedup
1. Enable ##requireSourceExcerpt## and ##requireSourceUrl## if disabled
1. Consider using "High-Stakes" profile template as starting point

----

== 8. Admin Tools (v2.10) ==

=== 8.1 Active Config Dashboard ===

**Location**: Top of ##/admin/config## page

**Purpose**: Visual overview of all currently active configurations at a glance.

**Features**:
* Color-coded cards for each config type (Search, Calculation, Pipeline, Prompts, SR)
* Shows version label for each active config
* Displays activation timestamp
* Grouped by profile key

**Use Case**: Quickly understand current system state before making changes.

=== 8.2 Config Search by Hash ===

**Location**: Top of ##/admin/config## page

**Purpose**: Find configs by content hash for debugging and traceability.

**How to Use**:
1. Enter full or partial hash (minimum 4 characters)
1. Press Enter or click "Search"
1. Results show matching configs across all types
1. Click result to navigate directly to that config version

**Use Case**: When debugging a job report that shows a config hash, quickly find the exact config that was used.

=== 8.3 Version Comparison (Diff View) ===

**Location**: History tab in ##/admin/config##

**Purpose**: Compare any two config versions side-by-side.

**How to Use**:
1. Go to History tab
1. Check boxes next to two versions to compare
1. Click "Compare Selected"
1. Diff view shows:
** JSON configs: Field-by-field changes with added/removed/modified indicators
** Prompts: Side-by-side text comparison

**Color Coding**:
* Green: Added fields/lines
* Red: Removed fields/lines
* Yellow: Modified fields

**Use Case**: Understand what changed between versions when reviewing history.

=== 8.4 Default Value Indicators ===

**Location**: Active Config view (when viewing active config for JSON types)

**Purpose**: Identify which settings are customized from defaults.

**Visual Indicators**:
* **Green banner**: "Using default configuration" — no customizations
* **Yellow banner**: Shows count of customized fields with percentage

**Expandable Details**: Click to see exact field paths that differ from defaults.

**Use Case**: Quickly identify if a config has been customized and which fields changed.

=== 8.5 Export All Configs ===

**Location**: ##/admin## page (main admin dashboard)

**Purpose**: Create complete backup of all active configurations.

**How to Use**:
1. Navigate to Admin Dashboard
1. Click "Export All Configurations"
1. Downloads JSON file with all configs

**Export Format**:

{{code language="json"}}
{
  "exportedAt": "2026-01-31T14:30:00Z",
  "analyzerVersion": "2.10.0",
  "schemaVersion": "1.0",
  "configs": {
    "pipeline": { "default": {} },
    "search": { "default": {} },
    "calculation": { "default": {} },
    "prompt": { "default": {} }
  }
}
{{/code}}

**Use Cases**:
* Disaster recovery backup
* Environment migration
* Version control of configurations

=== 8.6 Toast Notifications ===

**Behavior**: All admin operations now use professional toast notifications instead of browser alerts.

**Toast Types**:
* **Success** (green): Operation completed successfully
* **Error** (red): Operation failed — includes error details
* **Info** (default): Informational feedback

**Features**:
* Non-blocking (can continue working while notification shows)
* Auto-dismiss after 3–5 seconds
* Errors persist until dismissed
* Multiple toasts stack properly

----

== Appendix A: Default Profile Settings ==

=== Default SearchConfig ===

{{code language="json"}}
{
  "enabled": true,
  "provider": "auto",
  "mode": "standard",
  "maxResults": 6,
  "maxSourcesPerIteration": 4,
  "timeoutMs": 12000,
  "dateRestrict": null,
  "domainWhitelist": [],
  "domainBlacklist": []
}
{{/code}}

=== Default Prompt Profiles ===

Prompt defaults are seeded from markdown files, one profile per prompt domain:

|= Profile Key |= Default File
| ##orchestrated## | ##apps/web/prompts/orchestrated.prompt.md##
| ##monolithic-dynamic## | ##apps/web/prompts/monolithic-dynamic.prompt.md##
| ##source-reliability## | ##apps/web/prompts/source-reliability.prompt.md##
| ##text-analysis-input## | ##apps/web/prompts/text-analysis/text-analysis-input.prompt.md##
| ##text-analysis-evidence## | ##apps/web/prompts/text-analysis/text-analysis-evidence.prompt.md##
| ##text-analysis-context## | ##apps/web/prompts/text-analysis/text-analysis-context.prompt.md##
| ##text-analysis-verdict## | ##apps/web/prompts/text-analysis/text-analysis-verdict.prompt.md##

=== Default CalcConfig ===

{{code language="json"}}
{
  "verdictBands": {
    "true": [86, 100],
    "mostlyTrue": [72, 85],
    "leaningTrue": [58, 71],
    "mixed": [43, 57],
    "leaningFalse": [29, 42],
    "mostlyFalse": [15, 28],
    "false": [0, 14]
  },
  "aggregation": {
    "centralityWeights": { "high": 3.0, "medium": 2.0, "low": 1.0 },
    "harmPotentialMultiplier": 1.5,
    "contestationWeights": { "established": 0.3, "disputed": 0.5, "opinion": 1.0 }
  },
  "probativeValueWeights": {
    "high": 1.0,
    "medium": 0.8,
    "low": 0.5
  },
  "sourceTypeCalibration": {
    "peer_reviewed_study": 1.0,
    "fact_check_report": 1.05,
    "government_report": 1.0,
    "legal_document": 1.0,
    "news_primary": 1.0,
    "news_secondary": 0.95,
    "expert_statement": 0.9,
    "organization_report": 0.95,
    "other": 0.8
  },
  "evidenceFilter": {
    "minStatementLength": 20,
    "maxVaguePhraseCount": 2,
    "requireSourceExcerpt": true,
    "minExcerptLength": 30,
    "requireSourceUrl": true,
    "deduplicationThreshold": 0.85
  }
}
{{/code}}

----

== Related ==

* [[Admin Interface>>FactHarbor.Product Development.DevOps.Subsystems and Components.Admin Interface.WebHome]] — Admin panel and GUI mechanics
* [[LLM Configuration>>FactHarbor.Product Development.DevOps.Subsystems and Components.LLM Configuration.WebHome]] — Provider configuration and cost optimization
* [[Getting Started>>FactHarbor.Product Development.DevOps.Guidelines.Getting Started.WebHome]] — Installation and first-run setup
* [[Architecture>>FactHarbor.Product Development.Specification.Architecture.WebHome]] — System architecture and key diagrams
