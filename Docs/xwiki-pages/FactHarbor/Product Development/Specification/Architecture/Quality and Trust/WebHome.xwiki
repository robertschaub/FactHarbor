= Quality and Trust =

FactHarbor employs multiple quality mechanisms to ensure analysis results are trustworthy: quality gates validate input and output, a defence-in-depth system ensures evidence and verdict quality, source reliability scoring evaluates source credibility, and a confidence calibration pipeline prevents misleading confidence scores.

== Quality Gates ==

Two quality gates are integrated into the AKEL pipeline: Gate 1 validates claims at input, Gate 4 assesses verdict confidence at output.

{{include reference="FactHarbor.Product Development.Diagrams.Quality Gates Flow.WebHome"/}}

//Gate 1 filters non-factual claims (opinions, predictions) before research begins. Gate 4 evaluates verdict quality based on evidence count, source quality, and evidence agreement — only HIGH and MEDIUM confidence verdicts are published without flags.//

=== Gate 1: Claim Validation ===

|= Check |= Purpose |= Pass Criteria
| Factuality test | Can the claim be proven true or false? | Must be verifiable
| Opinion detection | Contains subjective language? | Opinion score <= 0.3
| Specificity check | Contains concrete, testable details? | Specificity score >= 0.3
| Future prediction | About future events? | Must be about past or present

=== Gate 4: Confidence Assessment ===

|= Tier |= Evidence Sources |= Avg Quality |= Agreement |= Action
| **HIGH** | 3+ | >= 0.7 | >= 80% | Publish
| **MEDIUM** | 2+ | >= 0.6 | >= 60% | Publish
| **LOW** | 2+ | >= 0.5 | >= 40% | Flag for review
| **INSUFFICIENT** | < 2 | Any | Any | More research needed

== Evidence Quality: Defence in Depth ==

Evidence and verdicts are protected by a **two-phase defence** system. Phase 1 operates before verdict generation (ensuring only quality evidence reaches aggregation). Phase 2 operates after verdict generation (ensuring verdicts are sound).

{{include reference="FactHarbor.Product Development.Diagrams.Evidence Defence in Depth.WebHome"/}}

//Phase 1 (blue) filters evidence before verdict generation: LLM-guided extraction, deterministic quality filters, and provenance validation. Phase 2 (yellow) protects verdict quality: source reliability weighting, aggregation pruning of tangential/opinion-only claims, and verdict corrections.//

=== Phase 1: Evidence Quality (Pre-Verdict) ===

|= Step |= Type |= What It Filters
| LLM Prompt Instructions | Soft (LLM) | Guides extraction: require excerpts, avoid vague statements, cite sources
| Deterministic Filter | Hard (code) | Min 20 chars, 13 vague phrase patterns, Jaccard deduplication (0.85), category-specific rules (statistics need numbers, quotes need attribution), probative value scoring
| Provenance Validation | Hard (code) | Rejects synthetic/LLM-generated content, requires URL and source excerpt

=== Phase 2: Verdict Quality (Post-Verdict) ===

|= Step |= Type |= What It Filters
| Source Reliability Weighting | Soft (scoring) | Domain credibility score (0.0-1.0) weights evidence strength in aggregation
| Aggregation Pruning | Hard (code) | Removes tangential baseless claims, zero-weights tangential claims, prunes opinion-only KeyFactors, validates contestation factual basis
| Verdict Corrections | Hard (code) | Detects and corrects verdicts that contradict their own evidence

== Source Reliability ==

Source reliability scoring evaluates the credibility of web domains using LLM-based assessment with consensus scoring.

|= Feature |= Description
| **7-band credibility scale** | Authoritative (90+), Highly Credible (80-89), Credible (70-79), Moderately Credible (60-69), Mixed (50-59), Low Credibility (30-49), Unreliable (<30)
| **LLM evaluation** | Domain assessed for editorial standards, fact-checking history, transparency, bias indicators
| **Multi-model consensus** | Multiple LLM evaluations averaged for stability (configurable via UCM)
| **SQLite cache** | Evaluations cached for 90 days (configurable) to avoid redundant LLM calls
| **Evidence weighting** | Source reliability score directly influences evidence weight in verdict calculations

For implementation details, see [[Source Reliability Deep Dive>>FactHarbor.Product Development.Specification.Architecture.Deep Dive.Source Reliability.WebHome]].

== Confidence Calibration ==

A 4-layer deterministic post-processing system prevents misleading confidence scores.

{{mermaid}}
flowchart LR
    RAW["Raw LLM\nConfidence"]
    D["Density\nAnchor"]
    B["Band\nSnapping"]
    V["Verdict\nCoupling"]
    C["Context\nConsistency"]
    CAL["Calibrated\nConfidence"]

    RAW --> D --> B --> V --> C --> CAL

    style RAW fill:#ffcdd2,stroke:#b71c1c,color:#000
    style CAL fill:#c8e6c9,stroke:#2e7d32,color:#000
    style D fill:#e3f2fd,stroke:#1565c0,color:#000
    style B fill:#e3f2fd,stroke:#1565c0,color:#000
    style V fill:#e3f2fd,stroke:#1565c0,color:#000
    style C fill:#e3f2fd,stroke:#1565c0,color:#000
{{/mermaid}}

//Raw LLM confidence passes through 4 calibration layers: density anchor sets a minimum floor based on evidence quality, band snapping reduces jitter by aligning to a 7-band system, verdict coupling ensures strong verdicts have adequate confidence, and context consistency penalises divergent confidence across analysis contexts.//

|= Layer |= Purpose |= Effect
| **Evidence density anchor** | Sets minimum confidence floor based on evidence quality and quantity | Floor ranges from 15% (minimal evidence) to 60% (strong evidence)
| **Band snapping** | Aligns confidence to a 7-band system with partial blending (strength 0.7) | Reduces run-to-run jitter by ~5-10pp
| **Verdict-confidence coupling** | Ensures strong verdicts (>=70% or <=30% truth) have confidence >= 50% | Prevents "TRUE with 20% confidence" anomalies
| **Context consistency** | Penalises confidence divergence >25pp across analysis contexts | Ensures consistent confidence across perspectives

=== Additional Confidence Penalties ===

|= Penalty |= Trigger |= Effect
| **Graduated recency penalty** | Evidence is dated (staleness x volatility x volume formula) | Reduces confidence proportionally to evidence age
| **Low-source penalty** | 2 or fewer sources found | -15pp confidence (configurable)
| **Confidence floor** | Always applied | Minimum 10% confidence (configurable)

All calibration layers are configurable via UCM (##confidenceCalibration## section in Calculation Config) and can be individually toggled on/off.

== Deep Dives ==

* [[Quality Gates>>FactHarbor.Product Development.Specification.Architecture.Deep Dive.Quality Gates.WebHome]] — Detailed Gate 1 and Gate 4 reference with examples
* [[Evidence Quality Filtering>>FactHarbor.Product Development.Specification.Architecture.Deep Dive.Evidence Quality Filtering.WebHome]] — Detailed 7-layer filtering pipeline (code-level reference), filter rules, troubleshooting
* [[Source Reliability>>FactHarbor.Product Development.Specification.Architecture.Deep Dive.Source Reliability.WebHome]] — Evaluation methodology, caching, multi-language support
* [[Confidence Calibration>>FactHarbor.Product Development.Specification.Architecture.Deep Dive.Confidence Calibration.WebHome]] — Layer-by-layer detail, formulas, configuration reference
* [[Calculations and Verdicts>>FactHarbor.Product Development.Specification.Architecture.Deep Dive.Calculations and Verdicts.WebHome]] — Aggregation hierarchy, weighting formulas

----

**Navigation:** [[Architecture>>FactHarbor.Product Development.Specification.Architecture.WebHome]] | Prev: [[Storage and Configuration>>FactHarbor.Product Development.Specification.Architecture.Storage and Configuration.WebHome]] | Next: [[Security and Operations>>FactHarbor.Product Development.Specification.Architecture.Security and Operations.WebHome]]
